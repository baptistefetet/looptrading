# Story 3.3: Calcul des indicateurs de momentum et volatilité

## Status
Draft

## Story
**As a** user,
**I want** momentum and volatility indicators,
**so that** I can assess stock dynamics.

## Acceptance Criteria
1. Calcul RSI (14 périodes)
2. Calcul MACD (12, 26, 9)
3. Calcul Bollinger Bands (20, 2)
4. Calcul OBV (On-Balance Volume)
5. Calcul Volume moyen 20 jours
6. Tous inclus dans l'endpoint indicators
7. Tests unitaires pour chaque indicateur

## Tasks / Subtasks
- [ ] Implémenter calcul RSI (AC: 1)
  - [ ] Fonction `calculateRSI(prices, period=14)`
  - [ ] Calcul gains/pertes moyens
  - [ ] Normalisation 0-100
- [ ] Implémenter calcul MACD (AC: 2)
  - [ ] Fonction `calculateMACD(prices, fast=12, slow=26, signal=9)`
  - [ ] Ligne MACD = EMA12 - EMA26
  - [ ] Ligne Signal = EMA9 du MACD
  - [ ] Histogramme = MACD - Signal
- [ ] Implémenter Bollinger Bands (AC: 3)
  - [ ] Fonction `calculateBollingerBands(prices, period=20, stdDev=2)`
  - [ ] Bande médiane = SMA20
  - [ ] Bande haute = SMA + 2×écart-type
  - [ ] Bande basse = SMA - 2×écart-type
- [ ] Implémenter OBV (AC: 4)
  - [ ] Fonction `calculateOBV(prices, volumes)`
  - [ ] Cumul volume selon direction prix
- [ ] Implémenter Volume moyen (AC: 5)
  - [ ] Fonction `calculateAverageVolume(volumes, period=20)`
  - [ ] Ratio volume actuel / moyenne
- [ ] Intégrer à l'endpoint (AC: 6)
  - [ ] Ajouter tous les indicateurs
  - [ ] Structure de réponse cohérente
- [ ] Écrire tests unitaires (AC: 7)
  - [ ] Test RSI avec données connues
  - [ ] Test MACD avec données connues
  - [ ] Test Bollinger avec données connues
  - [ ] Test OBV avec données connues

## Dev Notes
_À compléter après création du document d'architecture_

### Architecture References
- FR10 : RSI (14), MACD (12, 26, 9), Bollinger Bands (20, 2), OBV, Volume moyen 20j

### Formulas
```
RSI = 100 - (100 / (1 + RS))
où RS = moyenne des gains / moyenne des pertes

MACD Line = EMA(12) - EMA(26)
Signal Line = EMA(9) du MACD
Histogram = MACD - Signal

Bollinger Upper = SMA(20) + 2 × σ
Bollinger Lower = SMA(20) - 2 × σ

OBV = OBV précédent ± volume du jour (selon direction prix)
```

### Dependencies
- Story 3.1 (MarketDataService) doit être complétée
- Story 3.2 (SMA/EMA) doit être complétée (réutilisation des fonctions)

### Testing
_Standards de test à définir dans le document d'architecture_

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-25 | 0.1 | Création initiale de la story | Sarah (PO) |
